# РЕШЕНИЕ ПРОБЛЕМЫ ПЕРЕКЛЮЧЕНИЯ АУДИО

## Диагностика

Проблема: приложение запускает старый код STT сервера без динамического мониторинга.

## Решение 1: Перезапуск через терминал

1. **Закройте приложение полностью**

2. **Остановите все процессы Python**:

   ```cmd
   taskkill /F /IM python.exe
   ```

3. **Запустите сервер вручную**:

   ```cmd
   cd python
   python stt_server.py --mode auto
   ```

4. **В другом терминале запустите приложение**:

   ```cmd
   npm start
   ```

## Решение 2: Проверка кода

Убедитесь, что в `python/stt_server.py` есть:

- Импорт `from dynamic_audio_capture import DynamicAudioCapture`
- Класс `DynamicSTTServer`
- Параметр `--mode auto` в main()

## Решение 3: Отладка

Если не работает, запустите тест:

```cmd
python test_websocket.py
```

Должно вывести:

```text
Connected to STT server
Status: {'type': 'status', 'mode': 'loopback', 'message': 'STT server running...'}
```

## Что должно происходить при переключении

При переключении аудиоустройства в консоли должно появиться:

```text
[DeviceMonitor] Изменение устройства: "Monitor" -> "Наушники"
[DynamicAudioCapture] Перезапуск захвата с нового устройства
```

## Если всё равно не работает

Возможные причины:

- Приложение кэшировано - удалите node_modules и переустановите
- Нет прав на аудиоустройства - проверьте Windows Settings → Privacy
- Устройство не поддерживается loopback - используйте микрофонный режим
