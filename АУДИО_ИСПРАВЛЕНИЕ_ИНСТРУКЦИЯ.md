# ИНСТРУКЦИЯ: Исправление переключения аудио

## Что сделано

1. Создан новый STT сервер с динамическим захватом аудио
2. Сервер автоматически отслеживает изменения устройства по умолчанию
3. При переключении с Монитора на Наушники (или обратно) capture перезапускается автоматически

## Как проверить

1. **Закройте приложение Live Hints** (если открыто)

2. **Запустите приложение заново**
   - Нажмите Win+R
   - Введите: `cd C:\Users\RODION\CascadeProjects\live-hints && npm start`
   - Или просто перезапустите из терминала

3. **Проверьте логи при запуске**
   - В консоли должно быть: `STT-Dynamic: Auto-detected audio mode: loopback` или `microphone`

4. **Тест переключения**
   - Запустите транскрипцию (Start Recording)
   - Переключите звук с Монитора на Наушники
   - В логах должно появиться сообщение о переключении устройства
   - Транскрипция должна продолжиться!

## Если не работает

1. **Проверьте, что запущен правильный сервер**

   ```bash
   netstat -ano | findstr :8765
   wmic process where "ProcessId=<PID>" get CommandLine
   ```

   Должно быть: `stt_server_dynamic.py`

2. **Перезапустите вручную STT сервер**

   - Остановите старый: `taskkill /F /PID <PID>`
   - Запустите новый:

   ```bash
   cd python
   python stt_server_dynamic.py --mode auto
   ```

3. **Проверьте права доступа**

   - Убедитесь, что приложение имеет доступ к аудиоустройствам
   - В Windows Settings → Privacy → Microphone разрешите доступ

## Логи переключения

При успешном переключении в логах будет:

```
[DeviceMonitor] Изменение устройства: "Monitor" -> "EDIFIER W820NB Plus"
[DynamicAudioCapture] Начало захвата с устройства: EDIFIER W820NB Plus
```

## Дополнительно

- Сервер проверяет устройства каждую секунду
- Поддерживаются любые USB/Bluetooth наушники, колонки, микрофоны
- Работает как с loopback (системный звук), так и с микрофонами
